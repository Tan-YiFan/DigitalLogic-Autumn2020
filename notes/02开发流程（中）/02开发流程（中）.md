# 数字逻辑与部件设计 实验部分-02.开发流程（中）

Convert code to circuit.

[TOC]

## 将已有的代码生成bit文件

我们已经学会了如何将bit文件载入实验板。现在，我们来学一下，有了硬件代码，如何生成bit文件。

### Step 0：在Vivado安装目录中添加实验板信息

将 `board_files.zip`的两个文件夹解压至 `<VivadoInstallDir>/data/boards/board_files/`。

解压后的目录应如图所示：

![board_files](assets/board_files.PNG)

### Step 1：新建项目

打开Vivado，点击 `Create Project`，新建一个项目。

选择项目路径后，点下一步选择 `RTL Project` ，然后一直点击下一步，直到 `Default Part` 这个界面：

![default_part](assets/default_part.PNG)

点击上方的 `Boards`，选择 `Nexys DDR`，然后一直点下一步，直到项目新建成功。

![default_board](assets/default_board.PNG)

### Step 2：运行tcl脚本添加源文件

运行 `source/`目录下的 `sources.tcl`，一键添加所有需要的源文件。

`sources.tcl`的内容如下：

```tcl
# 进入当前目录
cd [file dirname [info script]]

# 添加所需源文件
add_files top.sv
add_files controller.sv

# 设置顶层文件
set_property top top [current_fileset]

cd [file dirname [info script]]

# 添加顶层约束文件
add_files -fileset constrs_1 -norecurse Nexys4DDR_Master.xdc

# 设置仿真文件
set_property SOURCE_SET sources_1 [get_filesets sim_1]
# 添加仿真文件
add_files -fileset sim_1 -norecurse sim.sv
# 设置仿真顶层
set_property top sim [get_filesets sim_1]
set_property top_lib xil_defaultlib [get_filesets sim_1]
```

这些tcl代码对应的操作都有图形化界面的操作对应。

### Step 3：开启多线程(optional)

在 `Tcl Console`中输入 `set_param general.maxThreads 16`开启多线程模式，对接下来的Step 4有一定的加速效果。

### Step 4：生成bitstream

点击Vivado界面左下角的 `Generate Bitstream`，然后一直选 `Yes`，有默认框的就✔一下，减少今后操作的点击次数。

有一步是确认用多少个job，这个对速度影响不大。

也可在 `Tcl Console`中输入： `reset_run synth_1; launch_runs impl_1 -to_step write_bitstream`

### Step 5：上板

点击左下角的 `Open target` --> `Auto Connect` --> `Program Device`，把默认的bitstream（路径应包含 `impl_1/` ）烧写到实验板上。

实验板的现象和上一节课提供的bit文件一样。

## 硬件描述语言简介



## SystemVerilog基础语法：变量